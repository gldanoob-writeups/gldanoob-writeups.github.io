<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><link rel=stylesheet href=/markdown.css><link rel=stylesheet href=/highlight.css><title>IrisCTF 2024 Solution Guide - What the Beep (Forensics) | CTF Writeups</title>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js crossorigin=anonymous></script><script>window.onload=()=>renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]})</script></head><script>addEventListener("load",()=>{console.log("nothing to see here yo")},!1)</script><body><article class=container><div class=title>IrisCTF 2024 Solution Guide - What the Beep (Forensics)</div><div class=date>Jan 8, 2024</div><p>CTF challenges can be intimidating for beginners, especially those
without much technical background. This is a step-by-step guide to the
<a href=https://ctftime.org/event/2085>IrisCTF 2024</a> challenge
“What the Beep”, aiming to show both the thought process and the details
of how I solved it, and how you can too, even without a lot of prior
knowledge.</p><h2 id=skills-required>Skills Required</h2><ul><li>Googling</li><li>Use of web applications</li><li>Some algebra</li><li>Basic Python scripting</li></ul><h2 id=first-look>First Look</h2><blockquote><p><strong>Challenge Description</strong><br>A strange beep sound was heard across a part of the San Joaquin Valley.
We have the records from some audio volume meters at various locations
nearby that picked up this event. It’s understood that the original
sound was about 140 dB at the source, but can you find out where it
originated from?</p></blockquote><p>Let’s download the attached file and see what it has…</p><p>“Wait, the file has a weird extension <code>.tar.gz</code>. How do I
even open it?”</p><blockquote><p><strong><em>Tip</em></strong><br>Whenever you encounter something you’ve never seen before, just <a href=https://www.cyberciti.biz/faq/how-to-create-tar-gz-file-in-linux-using-command-line/>look
it up</a>.</p></blockquote><figure><img src=image.png alt="Alt text"><figcaption aria-hidden=true>Alt text</figcaption></figure><p>Ok, let’s see what we get inside the folder.</p><figure><img src=folder.png alt="Alt text"><figcaption aria-hidden=true>Alt text</figcaption></figure><p>The names of the HTML files resemble <strong><a href=https://en.wikipedia.org/wiki/Geographic_coordinate_system>GPS
coordinates</a></strong>, and if we open one of them in a browser it
shows a graph as follows:</p><figure><img src=graph.png alt="Alt text"><figcaption aria-hidden=true>Alt text</figcaption></figure><p>As the x and y axis have units of time (<span class="math inline">\(\text{s}\)</span>) and decibel (<span class="math inline">\(\text{dB}\)</span>) respectively, it’s reasonable
to assume that the graph shows the <strong>sound level at the
corresponding time</strong>, in which there is a peak in loudness for
about 2 seconds, at around <span class="math inline">\(50
\text{dB}\)</span>. That matches the “loud beep” description, and the
attached audio file:</p><figure><audio src=strange-sound.mp3 controls><a href=strange-sound.mp3>beep</a></audio><figcaption aria-hidden=true>beep</figcaption></figure><p>Let’s wrap up what information we have so far:</p><ul><li>A recording of a loud beep</li><li>Four pairs of <strong>GPS coordinates</strong>, each with a graph of
<strong>sound level</strong> over time</li></ul><p>From the above, we can infer that the challenge is about
<strong>finding the location of the sound</strong>, given the intensity
of the sound recorded at different locations.</p><h2 id=the-approach>The Approach</h2><p>To clear things up, let’s sketch a diagram of the situation:</p><blockquote><p><strong><em>Tip</em></strong><br>Diagrams are always helpful, especially when you are stuck.</p></blockquote><figure><img src=image(1).png alt="Bad drawing"><figcaption aria-hidden=true>Bad drawing</figcaption></figure><p>If we worked out <span class="math inline">\(r_A\)</span> to <span class="math inline">\(r_D\)</span>, the distance between the sound
source and each of the four locations, the location of the source could
be easily found by <strong>drawing four circles</strong> around <span class="math inline">\(A\)</span> to <span class="math inline">\(D\)</span> with radii <span class="math inline">\(r_A\)</span> to <span class="math inline">\(r_D\)</span> respectively, and look for their
<strong>intersection</strong>:</p><figure><img src=circles.png alt="Bad drawing 2"><figcaption aria-hidden=true>Bad drawing 2</figcaption></figure><p>This graphical method is simple and intuitive, as it avoids solving
for the coordinates of the source by hand, but it’s not very accurate.
However it suits our purpose as we only need to find the
<strong>approximate location</strong> of the sound source.</p><h2 id=physics-comes-in-handy>Physics Comes In Handy</h2><p>Now that we only have the sound intensity, we need a way to work out
the distance between the source and each location. We all know we can
<strong>judge a distance simply by the loudness of a sound</strong>, but
how do we actually <em>calculate</em> it?</p><p>That might sound familiar to you if you took high school physics, as
it’s the <a href=https://en.wikipedia.org/wiki/Inverse-square_law><strong>inverse
square law</strong></a>:</p><p><span class="math display">\[\left(\frac{r_2}{r_1}\right)^2 =
\frac{I_1}{I_2}\]</span></p><p>where <span class="math inline">\(I_1\)</span> is the intensity at
distance <span class="math inline">\(r_1\)</span>, and <span class="math inline">\(r_2\)</span> is the distance at which <span class="math inline">\(I_2\)</span> is measured. Note how the fraction on
the right hand side is <em>inverted</em>, as it involves an inversely
proportional relationship.</p><p>The equation relates the intensity of sound at two different points
with their distances to the source. In our case, <span class="math inline">\(I_2\)</span> and <span class="math inline">\(r_2\)</span> represents the intensity and distance
at <span class="math inline">\(A\)</span> to <span class="math inline">\(D\)</span>, and <span class="math inline">\(I_1\)</span> and <span class="math inline">\(r_1\)</span> is what we get from a known
<strong>reference point</strong>. Where can we find such a reference
point?</p><figure><img src=hint.png alt=hint><figcaption aria-hidden=true>hint</figcaption></figure><p>Perfect! Now just set <span class="math inline">\(I_1\)</span> to
<span class="math inline">\(140 \text{dB}\)</span>, and <span class="math inline">\(r_1\)</span> to <span class="math inline">\(1 \
\text{ft}\)</span>… wait. That’s not how it works. The <strong>decibel
scale</strong> is <strong>logarithmic</strong> and
<strong>relative</strong> to a threshold <span class="math inline">\(I_0\)</span>, defined by: <span class="math display">\[ n = 10 \log_{10} \left(\frac{I}{I_0}\right)
\]</span> where <span class="math inline">\(n\)</span> is the sound
intensity in <span class="math inline">\(\text{dB}\)</span>. so we need
to convert it to a linear scale first: <span class="math display">\[\frac{I}{I_0} = 10^{n/10}\]</span></p><p>Luckily for us, we’re only interested in the <strong>ratio</strong>
of the sound intensity at different locations, so we can just ignore the
<span class="math inline">\(I_0\)</span> term and work it out directly:
<span class="math display">\[\frac{I_1}{I_2} =
\cfrac{\cfrac{I_1}{I_0}}{\cfrac{I_2}{I_0}} =
\cfrac{10^{{n_1}/{10}}}{10^{{n_2}/{10}}} = 10^{(n_1 - n_2)/10}
\]</span></p><blockquote><p>Intuitively, <strong>an increase of <span class="math inline">\(10
\text{dB}\)</span> means multiplying the intensity by 10</strong>. So to
find out the ratio between two different intensities <span class="math inline">\({I_1}\)</span> and <span class="math inline">\({I_2}\)</span>, we figure out <em>how many times
we have to add <span class="math inline">\(10\)</span> to get from <span class="math inline">\(n_2\)</span> to <span class="math inline">\(n_1\)</span></em>, then raise <span class="math inline">\(10\)</span> to that power.</p></blockquote><p>To sum up, if we were to find distance <span class="math inline">\(r_A\)</span>: <span class="math display">\[r_A =
r_1 \sqrt{10^{(n_1 - n_A)/10}} = (1 \ \text{ft}) \cdot \sqrt{10^{(140 -
n_A)/10}}\]</span></p><p>where <span class="math inline">\(n_A\)</span> is the intensity at
<span class="math inline">\(A\)</span>, measured in <span class="math inline">\(\text{dB}\)</span>.</p><h2 id=obtaining-the-data>Obtaining the Data</h2><p>Now our task is to extract the exact sound level from the graphs. But
here’s a small problem: we get little bumps on the curve during the
2-second beep:</p><figure><img src=zoom.png alt=zoom><figcaption aria-hidden=true>zoom</figcaption></figure><p><strong>There’s not only one number, but a range of numbers.</strong>
So we have to approximate the sound level instead, as accurately as
possible. The best way I can think of is to take the
<strong>average</strong> of the data points.</p><p>And rather than copying off the values one by one with the mouse, did
you notice how the graphs are <strong>interactive</strong>? The actual
data must be stored <em>somewhere</em> in the HTML file, and we can
<strong><a href=https://firefox-source-docs.mozilla.org/devtools-user/index.html>inspect</a></strong>
the page to find out where:</p><figure><img src=source.png alt="Alt text"><figcaption aria-hidden=true>Alt text</figcaption></figure><p>Note how the data is stored in the form of <strong><a href=https://developer.mozilla.org/en-US/docs/Learn/JavaScript/First_steps/Arrays>JavaScript
arrays</a></strong>. We can just copy the array and paste it into a text
editor, and treat it like Python lists:</p><div class=sourceCode id=cb1><pre class="sourceCode python"><code class="sourceCode python"><span id=cb1-1><a href=#cb1-1 aria-hidden=true tabindex=-1></a>data_a <span class=op>=</span> [<span class=fl>49.4862687673082</span>, <span class=fl>49.11758306247154</span>, <span class=fl>49.35891737763439</span>, <span class=fl>49.60312825002279</span>, <span class=fl>49.28094240869986</span>, <span class=fl>49.33179344636332</span>, <span class=fl>49.77218278810612</span>, <span class=fl>49.33157050295794</span>, <span class=fl>49.954163292100134</span>, <span class=fl>49.46399894576454</span>, <span class=fl>49.75225513933776</span>, <span class=fl>49.51956668498062</span>, <span class=fl>49.72709095876894</span>, <span class=fl>49.08380931815951</span>, <span class=fl>49.80535732712877</span>, <span class=fl>49.466366411374636</span>, <span class=fl>49.272738443513475</span>, <span class=fl>49.537197963188916</span>, <span class=fl>49.42320370510891</span>, <span class=fl>49.324671083447626</span>, <span class=fl>49.54118211146326</span>, <span class=fl>49.49531460381351</span>, <span class=fl>49.976621634496894</span>, <span class=fl>49.3893728063094</span>, <span class=fl>49.921942150468716</span>, <span class=fl>49.19386224160513</span>, <span class=fl>49.36279881936855</span>, <span class=fl>49.3589213415847</span>, <span class=fl>49.56066713691474</span>, <span class=fl>49.12186675176159</span>, <span class=fl>49.98362703411643</span>, <span class=fl>49.52541697547485</span>, <span class=fl>49.35868710209489</span>, <span class=fl>49.43923653057155</span>, <span class=fl>49.98372751405347</span>, <span class=fl>49.28405742162781</span>, <span class=fl>49.401207574823644</span>, <span class=fl>49.01614674667963</span>, <span class=fl>49.13219547793331</span>, <span class=fl>49.64847624718398</span>, <span class=fl>49.498071028322336</span>, <span class=fl>49.334549685095496</span>, <span class=fl>49.458331325541025</span>, <span class=fl>49.16635204000964</span>, <span class=fl>49.2845016923542</span>, <span class=fl>49.04043406000734</span>, <span class=fl>49.911997928476055</span>, <span class=fl>49.522384277676096</span>, <span class=fl>49.63639242519472</span>, <span class=fl>49.5321507012455</span>, <span class=fl>49.580222157005686</span>, <span class=fl>49.462799630990716</span>, <span class=fl>49.15286264591634</span>, <span class=fl>49.5636105290103</span>, <span class=fl>49.24446101814839</span>, <span class=fl>49.17815265294301</span>, <span class=fl>49.277052087309045</span>, <span class=fl>49.34785136315813</span>, <span class=fl>49.2099358209713</span>, <span class=fl>49.18130715442975</span>, <span class=fl>49.81637365701671</span>, <span class=fl>49.58976121006631</span>, <span class=fl>49.26447327335997</span>, <span class=fl>49.07489408373105</span>, <span class=fl>49.10738248956828</span>, <span class=fl>49.82935754558414</span>, <span class=fl>49.7076592827515</span>, <span class=fl>49.56229242462191</span>, <span class=fl>49.67051905124946</span>, <span class=fl>49.042312629812045</span>, <span class=fl>49.561770092276326</span>, <span class=fl>49.66475069029362</span>, <span class=fl>49.858494354189034</span>, <span class=fl>49.048272583835754</span>, <span class=fl>49.9132487579282</span>, <span class=fl>49.71779824360189</span>, <span class=fl>49.79452312717411</span>, <span class=fl>49.50065500658594</span>, <span class=fl>49.84834211295007</span>, <span class=fl>49.220394666568154</span>, <span class=fl>49.66254149768159</span>, <span class=fl>49.83640438670091</span>, <span class=fl>49.10061336144564</span>, <span class=fl>49.42849201280895</span>, <span class=fl>49.646915124964735</span>, <span class=fl>49.78950547033567</span>, <span class=fl>49.4929685819846</span>, <span class=fl>49.73705541695538</span>, <span class=fl>49.22359955303929</span>, <span class=fl>49.79862536749438</span>, <span class=fl>49.652865340678765</span>, <span class=fl>49.066372510572236</span>, <span class=fl>49.19935726756466</span>, <span class=fl>49.12145308818689</span>, <span class=fl>49.438711940843866</span>, <span class=fl>49.004099870912</span>, <span class=fl>49.502682207162174</span>, <span class=fl>49.293165246893956</span>, <span class=fl>49.112557507785844</span>, <span class=fl>49.544065615449895</span>,</span>
<span id=cb1-2><a href=#cb1-2 aria-hidden=true tabindex=-1></a>          <span class=fl>49.663019552626615</span>, <span class=fl>49.46132309525862</span>, <span class=fl>49.28867460561771</span>, <span class=fl>49.04716798758809</span>, <span class=fl>49.35484951313734</span>, <span class=fl>49.37733257790768</span>, <span class=fl>49.84822901146003</span>, <span class=fl>49.81145708386574</span>, <span class=fl>49.88943707227456</span>, <span class=fl>49.8760994755179</span>, <span class=fl>48.99312519891967</span>, <span class=fl>49.48120050185433</span>, <span class=fl>49.52537947160789</span>, <span class=fl>49.90610721676662</span>, <span class=fl>49.914515091218576</span>, <span class=fl>49.416331830579196</span>, <span class=fl>49.348693840298814</span>, <span class=fl>49.545231061032965</span>, <span class=fl>49.114561921757456</span>, <span class=fl>49.026512427769646</span>, <span class=fl>49.14711681989299</span>, <span class=fl>49.77105573603577</span>, <span class=fl>49.536523596883534</span>, <span class=fl>49.60021444492543</span>, <span class=fl>49.60605081543197</span>, <span class=fl>49.64891471841797</span>, <span class=fl>49.4600478177719</span>, <span class=fl>49.977585356380565</span>, <span class=fl>49.64790786367474</span>, <span class=fl>49.05339723365599</span>, <span class=fl>49.776801982915465</span>, <span class=fl>49.345914994020035</span>, <span class=fl>49.460170041286936</span>, <span class=fl>49.458597510753314</span>, <span class=fl>49.404020334240904</span>, <span class=fl>49.80110610568392</span>, <span class=fl>49.92580226915928</span>, <span class=fl>49.892740295161424</span>, <span class=fl>49.32725220374159</span>, <span class=fl>49.14689359709007</span>, <span class=fl>49.272749076596895</span>, <span class=fl>49.77397438750593</span>, <span class=fl>49.092844212042216</span>, <span class=fl>49.29759302412302</span>, <span class=fl>49.44741729129354</span>, <span class=fl>49.41099308272467</span>, <span class=fl>49.079825857328835</span>, <span class=fl>49.386676414641016</span>, <span class=fl>49.10972967558096</span>, <span class=fl>49.043040950598254</span>, <span class=fl>49.11993424749808</span>, <span class=fl>48.99318353627927</span>, <span class=fl>49.10530939042136</span>, <span class=fl>49.21146252088831</span>, <span class=fl>49.15074800916907</span>, <span class=fl>49.61678542581952</span>, <span class=fl>49.35038069687581</span>, <span class=fl>49.03078805691796</span>, <span class=fl>49.6258955230806</span>, <span class=fl>49.63094191644237</span>, <span class=fl>49.47515877815869</span>, <span class=fl>49.26668175133948</span>, <span class=fl>49.31472885646965</span>, <span class=fl>49.640732134272305</span>, <span class=fl>49.228802255830445</span>, <span class=fl>49.59159486655283</span>, <span class=fl>49.06310688917667</span>, <span class=fl>49.49737416549353</span>, <span class=fl>49.97771220245058</span>, <span class=fl>49.636406874411215</span>, <span class=fl>49.173004449388536</span>, <span class=fl>49.33266160439406</span>, <span class=fl>49.014913705550754</span>, <span class=fl>49.40246086899188</span>, <span class=fl>49.329105230947825</span>, <span class=fl>49.86540375321602</span>, <span class=fl>49.843613528504285</span>, <span class=fl>49.8657191427391</span>, <span class=fl>49.219049611824765</span>, <span class=fl>49.57851447868852</span>, <span class=fl>49.98526126350094</span>, <span class=fl>49.94445651733331</span>, <span class=fl>49.45467432812931</span>, <span class=fl>49.76296756625244</span>, <span class=fl>49.7935233989949</span>, <span class=fl>49.83262284962718</span>, <span class=fl>49.93995818802516</span>, <span class=fl>49.67306551801829</span>, <span class=fl>49.54206148681675</span>, <span class=fl>49.31504612258427</span>, <span class=fl>49.94311396484975</span>, <span class=fl>49.94210883611035</span>, <span class=fl>49.11875893744185</span>, <span class=fl>49.46127955948076</span>, <span class=fl>49.7357488917027</span>, <span class=fl>49.878480551044404</span>, <span class=fl>49.897911048398925</span>, <span class=fl>49.58542961303054</span>, <span class=fl>49.59108511515634</span>, <span class=fl>49.31169509848393</span>]</span></code></pre></div><p>I only extracted the numbers close to 50, since that’s the relevant
part of the graph. Now we can work out the distance <span class="math inline">\(r_A\)</span> in feet:</p><div class=sourceCode id=cb2><pre class="sourceCode python"><code class="sourceCode python"><span id=cb2-1><a href=#cb2-1 aria-hidden=true tabindex=-1></a><span class=im>import</span> math</span>
<span id=cb2-2><a href=#cb2-2 aria-hidden=true tabindex=-1></a>avg_n_a <span class=op>=</span> <span class=bu>sum</span>(data_a) <span class=op>/</span> <span class=bu>len</span>(data_a)</span>
<span id=cb2-3><a href=#cb2-3 aria-hidden=true tabindex=-1></a>r_a <span class=op>=</span> <span class=dv>1</span> <span class=op>*</span> math.sqrt(<span class=dv>10</span> <span class=op>**</span> ((<span class=dv>140</span> <span class=op>-</span> avg_n_a) <span class=op>/</span> <span class=dv>10</span>))</span>
<span id=cb2-4><a href=#cb2-4 aria-hidden=true tabindex=-1></a><span class=bu>print</span>(r_a)</span></code></pre></div><p>That would give us <code>33573.94482372866</code> feet (around 10
km), which looks reasonable.</p><p>Same goes for <span class="math inline">\(r_B\)</span>, <span class="math inline">\(r_C\)</span> and <span class="math inline">\(r_D\)</span>. Try working them out yourself!</p><blockquote><p><strong><em>Tip</em></strong><br>Work the smart way, not the hard way. Perhaps let your machine do the
job for you?</p></blockquote><h2 id=putting-it-all-together>Putting It All Together</h2><p>Now that we have the coordinates and distances, all that’s left is to
draw the circles on a map… is there any convenient map application that
allows us to draw circles? <img src=google.png alt="Alt text"></p><p><a href=https://www.mapdevelopers.com/draw-circle-tool.php>There we
are</a> (I have no idea why this exists). Let’s try to use it, pasting
in the coordinates and distances…</p><figure><img src=map.png alt="Alt text"><figcaption aria-hidden=true>Alt text</figcaption></figure><p>Ooh, there’s an intersection! But one of the circles looks off. What
went wrong? Let’s click on the circle around <span class="math inline">\(A\)</span>:</p><figure><img src=a.png alt="Alt text"><figcaption aria-hidden=true>Alt text</figcaption></figure><p>The coordinates shown for the circle is entirely different from what
we entered (<code>37.185287, -120.292548</code>)! How do we manually
correct it?</p><p>We see a <strong>generated URL</strong> for the created map, in a
text box below:</p><figure><img src=image-1.png alt="Alt text"><figcaption aria-hidden=true>Alt text</figcaption></figure><p>which <a href=https://www.semrush.com/blog/url-parameters/>contains
the wrong coordinates</a> of the circle. Now let’s do a little hack,
replacing the numbers with the correct ones:</p><pre><code>...%2C37.185287%2C-120.292548%2C...</code></pre><p>and finally pasting it into the address bar: <img src=correct.png alt="Alt text"></p><p>Voila! The circles now (<em>nearly</em>) intersect at a single point.
Pick a point best approximating the location of the sound source, and
we’re done!</p><figure><img src=ans.png alt="Alt text"><figcaption aria-hidden=true>Alt text</figcaption></figure><p>Where do we submit our answer? Let’s look at the challenge
description again: <img src=desc.png alt="Alt text"></p><p>“What’s the <em>answer checker service</em>? And what about
<code>nc what-the-beep.chal.irisc.tf 10500</code>?”</p><p>I’ll give you a hint: <code>nc</code> is short for <a href=https://nooblinux.com/how-to-use-netcat/><strong>Netcat</strong></a>.</p><figure><img src=nc.png alt="Alt text"><figcaption aria-hidden=true>Alt text</figcaption></figure><p>… no trick questions here, don’t worry. Just follow the instructions
and the sacred line of text you’ve been craving for shall reveal
itself:</p><figure><img src=flag.png alt="Alt text"><figcaption aria-hidden=true>Alt text</figcaption></figure><blockquote><p><strong><em>Tip</em></strong><br>If something is not working right, don’t complain. Hack your way around
it.</p></blockquote><h2 id=tldr-solution>TL;DR Solution</h2><ol type=1><li>Extract the <strong>average sound intensity</strong> from the
graphs, for each location</li><li>Use the <strong>inverse square law</strong> to <strong>calculate the
distance</strong> between the sound source and each location</li><li>Draw <strong>circles</strong> on a <strong>map</strong> with the
coordinates and distances</li><li>Find the <strong>intersection</strong> of the circles, and submit
the coordinates to the answer checker</li></ol><footer><span class=static>Powered by <a href=https://gohugo.io/>Hugo</a></span><br><span class=static>Emojis from <a href=https://blob.cat/>blob.cat</a></span></footer></article></body></html>